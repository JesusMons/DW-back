<div class="card">
  <div class="header">
    <h2>Itinerarios de Rutas</h2>

    <div class="filters">
      <input
        type="text"
        placeholder="Buscar por ruta, parada, bus, conductor…"
        [ngModel]="query()"
        (ngModelChange)="query.set($event)" />

      <select [ngModel]="filtroRuta()" (ngModelChange)="filtroRuta.set($event)">
        <option value="">Todas las rutas</option>
        @for (r of rutasDisponibles(); track r.id) {
          <option [value]="r.id">{{ r.id }} — {{ r.nombre }}</option>
        }
      </select>

      <select [ngModel]="filtroDia()" (ngModelChange)="filtroDia.set($event)">
        <option value="">Todos los días</option>
        @for (d of diasDisponibles; track d) {
          <option [value]="d">{{ d }}</option>
        }
      </select>

      <button class="btn btn-primary" [routerLink]="['/crear-itinerario']">
        + Nuevo Itinerario
      </button>
    </div>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>Itin.</th>
          <th>Ruta</th>
          <th>Orden</th>
          <th>Parada</th>
          <th>Hora</th>
          <th>Bus</th>
          <th>Conductor</th>
          <th>Días</th>
          <th style="width:150px;">Acciones</th>
        </tr>
      </thead>
      <tbody>
        @for (it of items(); track it.id) {
          <tr>
            <td>{{ it.id }}</td>
            <td><strong>{{ it.rutaId }}</strong> — {{ it.rutaNombre }}</td>
            <td>{{ it.orden }}</td>
            <td>{{ it.parada }}</td>
            <td>{{ it.hora }}</td>
            <td>{{ it.bus }}</td>
            <td>{{ it.conductor }}</td>
            <td class="dias">
              @for (d of it.dias; track d) {
                <span class="chip">{{ d }}</span>
              }
            </td>
            <td class="actions">
              <button class="btn btn-sm" [routerLink]="['/editar-itinerario']">Editar</button>
              <button class="btn btn-sm danger" (click)="eliminar(it)">Borrar</button>
            </td>
          </tr>
        } @empty {
          <tr>
            <td colspan="9" class="empty">No hay itinerarios para mostrar.</td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
